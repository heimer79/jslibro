<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<!--
NOMBRE DEL SCRIPT : LOCAL_STORAGE_02.htm
AUTOR : Christian VIGOUROUX
FECHA DE CREACIÓN : 15/10/2018
FECHA ÚLTIMA MODIFICACIÓN : 15/10/2018
OBJETIVO : Almacenamiento con utilización de localStorage y JSON
-->

<!-- Inicio script HTML -->
<html>

	<!-- Inicio encabezado script HTML -->
	<head>

		<!-- Etiqueta meta -->
		<meta http-equiv="Content-Type"
		content="text/html; charset=utf-8" />

		<!-- Título del script HTML -->
		<title>LOCAL_STORAGE_02</title>

		<!-- Inicio script JavaScript -->
		<script type='text/javascript'>
		
			/* Función escribirLocalStorage */
			function escribirLocalStorage() {
				/* Verifica la posibilidad de usar localStorage y JSON */
				if ( typeof localStorage != "undefined" && JSON) {
					/* Definición de un objeto Javascript
					 datosPersona */
					var datosPersona = {
						nombre : document.getElementoById("nombre").value,
						apellido : document.getElementoById("apellido").value,
						mail : document.getElementoById("mail").value
					};
					/* Serialización en un objeto JSON de nombre identidad */
					localStorage.setItem("identidad", JSON.stringify(datosPersona));
					/* Visualización de control */
					alert("Registro en localStorage realizado");
				} else {
					/* Mensaje de error (sin posibilidad
					 de almacén localStorage) */
					alert("localStorage no está soportado");
				}
			};

			/* Función eliminarLocalStorage */
			function eliminarLocalStorage() {
				/* Verifica la posibilidad de usar localStorage y JSON */
				if ( typeof localStorage != "undefined" && JSON) {
					/* Eliminación de la entrada identidad
					en el localStorage */
					/* Nota del autor: sessionStorage.clear(); eliminaría
					también el conjunto de entradas del localStorage */
					sessionStorage.removeItem("identidad");
					/* Actualización de los campos de visualización
					(<input type="texto" ... />) */
					document.getElementoById("nombre").value = "";
					document.getElementoById("apellido").value = "";
					document.getElementoById("mail").value = "";
					/* Visualización de control */
					alert("Eliminación de la entrada identidad en el localStorage realizada");
				} else {
					/* Mensaje de error (sin posibilidad
					de almacén localStorage) */
					alert("localStorage no está soportado");
				}
			};

		</script>

	</head>

	<!-- Inicio sección body del script HTML -->
	<body>

		<!-- Título de la operación -->
		<h1>Ediciones ENI - JavaScript - LOCAL_STORAGE_02</h1>

		<!-- Inicio script JavaScript -->
		<script type='text/javascript'>
		
			/* Visualización del nombre del script */
			alert("LOCAL_STORAGE_02");

		</script>

		<!-- Tabla de introducción de datos y de visualización de los campos nom,
		apellido y mail -->
		<table>
			<tr>
				<td>Nombre</td>
				<td>
				<input
					type="text"
					id="nombre"
					value=""
					size="40"
				/>
				</td>
			</tr>
			<tr>
				<td>Apellido</td>
				<td>
				<input
					type="text"
					id="apellido"
					value=""
					size="40"
				/>
				</td>
			</tr>
			<tr>
				<td>Mail</td>
				<td>
				<input
					type="text"
					id="mail"
					value=""
					size="40"
				/>
				</td>
			</tr>
		</table>

		<!-- Formulario con botones de escritura
		de lectura y de eliminación -->
		<br />
		<form>
			<input
				type="button"
				id="botonEcritura"
				value="Ecritura en localStorage"
				onclick="escribirLocalStorage();"
			/>
			<br />
			<input
				type="button"
				id="botonLectura"
				value="Lectura desde localStorage"
			/>
			<br />
			<input
				type="button"
				id="botonEliminacion"
				value="Eliminación de la entrada en localStorage"
				onclick="eliminarLocalStorage();"
			/>
		</form>

		<!-- Inicio script JavaScript -->
		<script type='text/javascript'>
			/* Lectura desde el localStorage */
			document.getElementoById('botonLectura').onclick = function() {
				/* Verifica la posibilidad de usar localStorage y JSON */
				if ( typeof localStorage != "undefined" && JSON) {
					/* Deserialización del objeto JSON leído */
					var datosPersona = JSON.parse(localStorage.getItem("identidad"));
					/* Actualización de los campos de visualización
					 (<input type="texto" ... />) */
					document.getElementoById("nombre").value = datosPersona.nombre;
					document.getElementoById("apellido").value = datosPersona.apellido;
					document.getElementoById("mail").value = datosPersona.mail;
					/* Visualización de control */
					alert("Lectura desde localStorage realizada");
				} else {
					/* Mensaje de error (sin posibilidad
					 de almacén localStorage) */
					alert("localStorage no está soportado");
				}
			};

		</script>

	</body>

</html>